<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Competencia de Dibujos</title>
<style>
    video {
        width: 100%;
        max-width: 600px;
        height: auto;
    }
</style>
</head>
<body>
<h1>Competencia de Dibujos</h1>
<video id="video" autoplay></video>
<button id="captureButton">Capturar Dibujo</button>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet"></script>
<script>
    async function startCamera() {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        const videoElement = document.getElementById('video');
        videoElement.srcObject = stream;
    }

    async function captureDrawing() {
        const videoElement = document.getElementById('video');
        const canvas = document.createElement('canvas');
        canvas.width = videoElement.videoWidth;
        canvas.height = videoElement.videoHeight;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(videoElement, 0, 0, canvas.width, canvas.height);

        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const model = await mobilenet.load();
        const predictions = await model.classify(imageData);

        // Calcular la "calidad" del dibujo basada en la cantidad de características detectadas
        const quality = predictions.length / 1000; // Normalizar el valor entre 0 y 1

        // Puedes ajustar este umbral según tus preferencias
        const goodDrawingThreshold = 0.5;

        if (quality > goodDrawingThreshold) {
            alert("¡Está bonito, te salvas!");
        } else {
            alert("Hmm, podrías intentarlo de nuevo.");
        }
    }

    document.getElementById('captureButton').addEventListener('click', captureDrawing);

    startCamera(); // Comenzar la cámara cuando se carga la página
</script>
</body>
</html>
